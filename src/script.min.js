/**
 * @author: Kapil Kashyap
 */
import e from"../assets/data/predefined-maze-coordinates.js";import t from"../assets/config.js";!function(){let s="north",n,o,i=3,l=3,r=s,a,c=0,u,d,f,h,p,L=[],$,m,v,y,g=["classic","challenge","maze"],E=g[0],_=!1,S,A,b,w,T,q,P,k,M,N,O,C,R=!1,I,U,B,z,D=e["12x12"],K,x=[],G=[],V=[],Y=[],W=[],H,j,X,F=0,Z,J=document.querySelector(".game-indicator .progress-bar"),Q=1,ee=document.querySelector(".level>.value"),et=!1,es=0,en=document.querySelector(".score>.value"),eo=!!/Android|webOS|iPhone|iPad|iPod|Opera Mini/i.test(navigator.userAgent)&&(/iPad/i.test(navigator.userAgent)?document.body.style.zoom="175%":document.body.style.zoom="200%",document.body.classList.add("portable-device"),!0),ei={START:eo?"Press play button to start.":"Press space bar to start.",RESET:eo?"Press reset button.":"Press 'R' to reset.",PAUSE:eo?"":"Press space bar to pause.",RESUME:eo?"Press play button to resume.":"Press space bar to resume.",LIVES_REMAINING:"lives remaining!",LIFE_REMAINING:"life remaining!",GAME_OVER:"Game over!",CONGRATULATIONS:"Congratulations",LEVEL_UNLOCKED:"level unlocked!",AMAZING:"Amazing",ALL_LEVELS_COMPLETED:"all levels completed!",TOP_N_SCORES:`Your top ${t.topScoreLimit} scores will appear here...`,PLAY_BUTTON_LABEL:"Play",PAUSE_BUTTON_LABEL:"Pause",DISCLAIMER:"Works best on desktop.",EXCLAMATION:"!",COMMA:", ",SPACE:" ",WELL_DONE:"Congratulations & well done! :)"},el=function(){let e=document.querySelector(".game-arena-display"),t=e.getBoundingClientRect(),s=e.querySelector("div"),n=eP(s),o=document.createElement("DIV"),i=null,l=1,r=1,a=eo&&null!=document.body.style.zoom?parseFloat(document.body.style.zoom)/100:1;u=Math.floor(t.height/a/n.height),f=(d=Math.floor(t.width/a/n.width))*u,L=[0,d],s.remove();for(let c=0;c<f;c++)r=c%d+1,c>=d&&1===r&&l++,(i=o.cloneNode()).setAttribute("data",[l,r]),i.setAttribute("class","empty rc_"+l+"_"+r),e.appendChild(i);td(L),e1(),j=ex(),eU(ei.START),ep(),er()},er=function(){document.body.addEventListener("wheel",function(e){e.preventDefault()},{passive:!1});let e;document.body.addEventListener("touchend",(e=0,function(t){let s=new Date().getTime(),n=s-e;n<500&&n>0&&t.preventDefault(),e=s}))},ea=function(e){e.addEventListener("touchstart",function(e){e.stopPropagation()}),e.addEventListener("touchend",function(e){e.stopPropagation()})},ec=function(e){let t=e.changedTouches[0];S=t.pageX,A=t.pageY,P=new Date().getTime(),_=!0,R=!1,e.preventDefault()},eu=function(e){if(_){let t=e.changedTouches[0];b=t.pageX,w=t.pageY,T=b-S,q=w-A,k=new Date().getTime()-P,N=Math.abs(Math.atan(q/T)*(180/Math.PI)),R=Math.abs(T)>25&&Math.abs(q)>25,k<=300&&(T>0&&q<0?N<O?M=["east"]:N>C?M=["north"]:R&&(M=["east","north"]):T<0&&q<0?N<O?M=["west"]:N>C?M=["north"]:R&&(M=["west","north"]):T<0&&q>0?N<O?M=["west"]:N>C?M=["south"]:R&&(M=["west","south"]):T>0&&q>0&&(N<O?M=["east"]:N>C?M=["south"]:R&&(M=["east","south"])),eL(M)),_=!1}e.preventDefault()},ed=function(){let e=document.querySelector(".body-container");null!==e&&(e.removeEventListener("touchstart",ec,{passive:!1}),e.removeEventListener("touchend",eu,{passive:!1}))},ef=function(){let e=document.querySelector(".body-container");null!==e&&(e.addEventListener("touchstart",ec,{passive:!1}),e.addEventListener("touchend",eu,{passive:!1}))},eh=function(){let e=document.querySelector(".gamepad");if(null!==e){let t=JSON.parse(ts("snake-game-settings"));e.classList.remove("show","hide"),null!==t&&t.useGamepad?(e.classList.add("show"),ed()):(e.classList.add("hide"),ef())}},ep=function(){document.querySelectorAll(".life .value span").forEach(function(e){e.innerHTML="&#9829;"}),document.addEventListener("keydown",function(e){e.stopPropagation(),e.preventDefault(),"ArrowUp"===e.code||"KeyW"===e.code?e.shiftKey&&("east"===r||"west"===r)?e$(["north",r]):e.ctrlKey&&("east"===r||"west"===r)?e$(["north","east"===r?"west":"east"]):em("north"):"ArrowRight"===e.code||"KeyD"===e.code?e.shiftKey&&("north"===r||"south"===r)?e$(["east",r]):e.ctrlKey&&("north"===r||"south"===r)?e$(["east","north"===r?"south":"north"]):em("east"):"ArrowDown"===e.code||"KeyS"===e.code?e.shiftKey&&("east"===r||"west"===r)?e$(["south",r]):e.ctrlKey&&("east"===r||"west"===r)?e$(["south","east"===r?"west":"east"]):em("south"):"ArrowLeft"===e.code||"KeyA"===e.code?e.shiftKey&&("north"===r||"south"===r)?e$(["west",r]):e.ctrlKey&&("north"===r||"south"===r)?e$(["west","north"===r?"south":"north"]):em("west"):"Space"===e.code&&("stopped"===H||void 0===H)?ev():"Space"===e.code&&"over"!==H?ey():"KeyR"===e.code&&void 0===I&&eg()}),eo&&(document.querySelector(".game-actions").classList.remove("hide"),ea(document.querySelector(".info .link")),eh(),document.querySelector(".game-actions .play-pause").addEventListener("touchstart",function(e){e.stopPropagation(),e.preventDefault(),e3(),"stopped"===H||void 0===H?ev():"over"!==H&&ey()},{passive:!1}),document.querySelector(".game-actions .reset").addEventListener("touchstart",function(e){e.stopPropagation(),e.preventDefault(),eD(!1),!this.querySelector("button").disabled&&void 0===I&&eg()},{passive:!1})),eB(),window.addEventListener("blur",function(){"play"===H&&ey()},{passive:!1})},eL=function(e){if(e){if(2===e.length){let t="east"===r||"west"===r;W.unshift(e[t?1:0]),W.unshift(e[t?0:1])}else em(e[0])}},e$=function(e){"play"===H&&(W.unshift(e[0]),W.unshift(e[1]))},em=function(e){"play"===H&&W[0]!==e&&("north"===e&&"south"!==W[0]&&"south"!==r?W.unshift(e):"east"===e&&"west"!==W[0]&&"west"!==r?W.unshift(e):"south"===e&&"north"!==W[0]&&"north"!==r?W.unshift(e):"west"===e&&"east"!==W[0]&&"east"!==r&&W.unshift(e))},ev=function(){e4(),eG(+ts("selected"+eq(E)+"Level")||1),e1(),eb(),ew(),void 0===H&&(e0(!0),tn()),eN(),eS("play"),eU(ei.PAUSE),eH(),eo&&eB(ei.PAUSE_BUTTON_LABEL)},ey=function(){"paused"!==H&&"lifeLost"!==H?(I=eT(I),U=eT(U),B=eT(B),z=eT(z),eS("paused"),eU(ei.RESUME),eo&&(eB(ei.PLAY_BUTTON_LABEL),e3(!1))):("paused"===H||"lifeLost"===H)&&(eR(),"lifeLost"===H&&(eM()||eY(),eE(),tn()),eb(),ew(),eS("play"),eU(ei.PAUSE),eo&&(eB(ei.PAUSE_BUTTON_LABEL),e3()))},eg=function(){eS("over"),eY(),e0(),eE(),eU(ei.START),eH(!1),tk(),eo&&(e5("play-pause"),eB(ei.PLAY_BUTTON_LABEL),e3()),eR(),eX()},eE=function(){e4(),I=void 0,z=eT(z),V=[],"over"===H?(eS(),l=3,eN(),es=0,en.innerText=es,e1()):!eM()&&c<x.length+G.length&&eN(x.length+G.length),document.querySelectorAll(".flicker").forEach(function(e){eF(e,"flicker")}),document.querySelectorAll(".food").forEach(function(e){eF(e,"food")})},e_=function(e){r=e||s},eS=function(e){H=e},eA=function(e){if(e===a)return;let t=null;"north"===e?t="east"===a?"se":"west"===a?"sw":null:"east"===e?t="south"===a?"sw":"north"===a?"nw":null:"south"===e?t="east"===a?"ne":"west"===a?"nw":null:"west"===e&&(t="south"===a?"se":"north"===a?"ne":null),t&&e6([n,o],t)},eb=function(e){I=eT(I),I=setInterval(function(){W.length>0&&(a=r,e_(W.pop()),eA(r)),tw()},e||p)},ew=function(){B=setInterval(function(){es+=Q*l,en.innerText=es},100)},eT=function(e){clearInterval(e)},eq=function(e){return e[0].toUpperCase()+e.slice(1)},eP=function(e){let t=getComputedStyle(e),s=parseFloat(t.marginLeft)+parseFloat(t.marginRight)+parseFloat(t.borderLeftWidth)+parseFloat(t.borderRightWidth)+parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)+parseFloat(t.width),n=parseFloat(t.marginTop)+parseFloat(t.marginBottom)+parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth)+parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)+parseFloat(t.height);return{width:s,height:n}},e8=function(){return"classic"===E},ek=function(){return"challenge"===E},eM=function(){return"maze"===E},eN=function(e){c=i=e||eO()},eO=function(){return e8()?1===Q?3:j*(Q-1):10+Q},eC=function(e){es+=(e||10)*Q},eR=function(){document.querySelectorAll(".game-arena-display div.trail").forEach(function(e){e.classList.remove("trail")})},eI=function(){document.querySelector("span.available:nth-of-type("+l--+")").classList.remove("available")},e0=function(e){document.querySelectorAll("span").forEach(function(t){t.classList[e?"add":"remove"]("available")})},eU=function(e){document.querySelector("div.message").innerHTML=e||""},eB=function(e){document.querySelector(".button.play-pause button").innerHTML=e||ei.PLAY_BUTTON_LABEL},ez=function(){O=eM()?45:27,C=eM()?45:63},eD=function(e){e=void 0===e||e,document.querySelector(".button.play-pause button").disabled=e},e3=function(e){e=void 0===e||e,document.querySelector(".button.reset button").disabled=e},e5=function(e,t){document.querySelector(".button."+e).classList[t?"add":"remove"]("hide")},e1=function(){p=eK()},eK=function(e){return(e=e||Q,ek())?340-20*e:eM()?440-24*e:440-40*e+(e>=9?20*(e-8):0)},ex=function(){return Math.round(Math.cbrt(y*v))},eG=function(e){Q=e,ee.innerText=e},e2=function(){let e,t=1;for(;e=eK(t),(!ek()||100!==e)&&(!eM()||152!==e)&&(!e8()||40!==e);t++){}X=t},eV=function(){if(e8())Z=100/(X*j);else if(ek()){let e=tu();Z=100/Math.pow(e[1]-e[0],2)}else eM()&&(Z=100/document.querySelectorAll(".maze-path").length)},eY=function(){x.concat(G).forEach(function(e){e9(e)}),setTimeout(function(){x=[],G=[]},0)},eW=function(){n=y,o=m,e_(s),W=[]},e4=function(){if(eM()){let e,t;n=+(t=(e="lifeLost"===H?document.querySelector(".maze-path.head"):document.querySelector(".maze-path.begin")).getAttribute("data").split(","))[0],o=+t[1],e_(e.getAttribute("direction")),"north"===r?n++:"south"===r?n--:"east"===r?o--:"west"===r&&o++,e.classList.remove("nw","ne","se","sw","nw-ne","ne-se","se-sw","sw-nw")}else eW()},eH=function(e){e=void 0===e||e,document.querySelector(".instructions").classList.remove("show","hide"),document.querySelector(".instructions").classList.add(e?"hide":"show"),e||ty()},e7=function(e){return e&&document.querySelector(".rc_"+e[0]+"_"+e[1])},ej=function(e){for(let t=1;t<=d;t++)e6([e[0],t],"crosshair");for(let s=1;s<=u;s++)e6([s,e[1]],"crosshair")},eX=function(){document.querySelectorAll(".crosshair").forEach(function(e){e.classList.remove("crosshair"),e8()&&e.classList.add("empty")})},e6=function(e,t){let s=e7(e);s&&("[object Array]"===Object.prototype.toString.call(t)?t.forEach(function(e){s.classList.add(e)}):s.classList.add(t),s.classList.remove("empty"))},eF=function(e,t){e&&("[object Array]"===Object.prototype.toString.call(t)?t.forEach(function(t){e.classList.remove(t)}):e.classList.remove(t),e.classList.add("empty"))},eZ=function(e,t,s){null!==s&&navigator.vibrate(s),eF(e7(e),t)},e9=function(e){if(void 0!==e){let t=e7(e);if(t){let s=t.classList.contains("tail");t.classList.remove("path","head","body","tail","trail","nw","ne","se","sw","nw-ne","ne-se","se-sw","sw-nw"),t.classList.add("empty"),!eM()&&s&&"play"===H&&t.classList.add("trail")}}},eJ=function(){for(let e,t=0;t<x.length;t++)if((e=e7(x[t]))&&(e.classList.remove("empty","head","body","trail","nw-ne","ne-se","se-sw","sw-nw"),e.classList.add("path",t===x.length-1?"head":"body"),0===t&&e.classList.add("tail"),t===x.length-1)){let s="";"north"===r?s="nw-ne":"east"===r?s="ne-se":"south"===r?s="se-sw":"west"===r&&(s="sw-nw"),e.classList.add(s)}},eQ=function(e,t){let s=e7(e);return!!s&&(eM()?s.classList.contains(t):!s.classList.contains(t))},te=function(e){let t=e7(e);return!(t&&eM())||t.classList.contains("maze-path")},tt=function(e,t){localStorage.setItem(e,t)},ts=function(e){return localStorage.getItem(e)},tn=function(){if(eM())return;let e=document.querySelectorAll(".game-arena-display div.empty:not(.head)");if(e.length>0){let t=e[Math.floor(Math.random()*e.length)].getAttribute("data").split(","),s=[+t[0],+t[1]];V.push(s.toString()),e6(s,"food"),eX(),ej(s)}},to=function(e,t){e=e||6;let s=document.querySelectorAll(".path");z=setInterval(function(){if(-1===e){z=eT(z);return}s.forEach(function(t){t.classList[e%2==0?"add":"remove"]("flicker")}),e--},200),navigator.vibrate(t||250)},ti=function(e){"paused"!==H&&(I=eT(I),eS("paused"));let t=setInterval(function(){eb(),eS("play"),eT(t)},e||1500)},tl=function(){let e=ts("snake-game-stats"),t=+ts("unlocked"+eq(E)+"Levels")||1,s={timestamp:new Date().getTime(),level:Q,score:es,selectedMode:E};if(null!==e){let n=(e=JSON.parse(e)).findIndex(function(e){return e.score<es});-1!==n?e.splice(n,0,s):e.push(s),tt("snake-game-stats",JSON.stringify(e))}else tt("snake-game-stats",JSON.stringify([s]));(e8()&&Q>t||et)&&(et=!1,!e8()&&Q++,tt("unlocked"+eq(E)+"Levels",Q)),tA()},tr=function(){return K=D[(+ts("selected"+eq(E)+"Level")||1)-1]},ta=function(){document.querySelectorAll(".maze-mode .maze-path").forEach(function(e){e.removeAttribute("direction"),e.classList.remove("maze-path","north","south","east","west","begin","end")}),document.querySelector(".game-arena-display").classList.remove("maze-mode")},tc=function(e){ta(),document.querySelector(".game-arena-display").classList.add("maze-mode"),e=e||u,tr();let t=e/Math.sqrt(K.length),s,n,o,i,l,r,a,c,d,f="maze-path",h=K.length,p=function(e){return Math.round((e+1)*t-1)};K.forEach(function(e,u){if(n="",i=e7([r=p(e[0]),a=p(e[1])]),s){s[0]>e[0]?n="north":s[0]<e[0]&&(n="south"),s[1]>e[1]?n="west":s[1]<e[1]&&(n="east"),c=p(s[0]),d=p(s[1]);for(let L=1;L<t;L++)"north"===n?c--:"south"===n?c++:"east"===n?d++:"west"===n&&d--,(l=e7([c,d])).classList.add(f,n),l.setAttribute("direction",n);o.classList.add(f),i.classList.add(f,n),o.setAttribute("direction",n),1===u&&o.classList.add(n)}else i.classList.add(f,"begin");h===u+1&&i.classList.add("end",f),s=e,o=i})},tu=function(){let e=+ts("selected"+eq(E)+"Level")||1,t,s=document.querySelector("body").classList.contains("dark");return h=Math.pow((t=e<=3?s?[12,28]:[9,27]:e>3&&e<=6?s?[10,30]:[6,30]:e>6&&e<=9?s?[5,35]:[3,33]:s?[0,40]:[0,36]).reduce((e,t)=>t-e),2),t},td=function(e){$=e[0]+1,m=e[0]+1,v=e[1],y=e[1],eW()},tf=function(e){e=e||tu(),th(),td(e),document.querySelector(".game-arena-display").classList.add("challenge-mode"),document.querySelectorAll(".empty").forEach(function(t){let s=t.getAttribute("data").split(",");(+s[0]<=e[0]||+s[0]>e[1]||+s[1]<=e[0]||+s[1]>e[1])&&(t.classList.remove("empty"),t.classList.add("danger"))})},th=function(){td(L),document.querySelectorAll(".danger").forEach(function(e){e.classList.remove("danger"),e.classList.add("empty")}),document.querySelector(".game-arena-display").classList.remove("challenge-mode")},tp=function(e){e.stopPropagation(),document.querySelector(".modes div.selected").classList.remove("selected"),this.classList.add("selected"),tt("selectedMode",E=this.getAttribute("data")),e2(),tm(),tv(),ty(),tg(),eM()?tc():ta(),ek()?tf():th(),eN(),tA(),eV(),tk(),ez()},tL=function(e){e.stopPropagation(),document.querySelector(".levels div.selected").classList.remove("selected"),this.classList.add("selected");let t=+this.getAttribute("data");tt("selected"+eq(E)+"Level",t),eM()&&tc(),ek()&&tf(),eN()},t$=function(){let e=JSON.parse(ts("unlockedModes"))||[E];E=ts("selectedMode")||E,document.querySelectorAll(".selectMode .modes .mode").forEach(function(t){let s=t.getAttribute("data");t.removeEventListener(eo?"touchstart":"click",tp),t.classList.remove("selected","enabled","disabled"),t.addEventListener(eo?"touchstart":"click",tp),s===E?t.classList.add("enabled","selected"):-1===e.indexOf(s.toLowerCase())?(t.classList.add("disabled"),t.removeEventListener(eo?"touchstart":"click",tp)):t.classList.add("enabled")}),eM()?tc():ek()&&tf()},tm=function(){document.querySelectorAll(".selectLevel .levels .level").forEach(function(e){e.remove()})},tv=function(){let e=document.querySelector(".selectLevel .levels"),t=document.createElement("DIV"),s;for(let n=1;n<=X;n++)(s=t.cloneNode()).setAttribute("data",n),s.setAttribute("class","level"),s.innerText=n,e.appendChild(s)},ty=function(){let e=+ts("selected"+eq(E)+"Level")||1,t=+ts("unlocked"+eq(E)+"Levels")||1;document.querySelectorAll(".selectLevel .levels .level").forEach(function(s,n){s.removeEventListener(eo?"touchstart":"click",tL),s.classList.remove("selected","enabled","disabled"),s.addEventListener(eo?"touchstart":"click",tL),e===n+1?s.classList.add("enabled","selected"):t<n+1?(s.classList.add("disabled"),s.removeEventListener(eo?"touchstart":"click",tL)):s.classList.add("enabled")})},tg=function(){document.querySelectorAll(".instructions .details .instruction").forEach(function(e){e.classList.contains(E+"-mode")?(e.classList.add("show"),e.classList.remove("hide")):(e.classList.remove("show"),e.classList.contains("hide")||e.classList.add("hide"))}),document.querySelectorAll(".handheld").forEach(e=>{e.classList.add(eo?"show":"hide"),e.classList.remove(eo?"hide":"show")}),document.querySelectorAll(".not-handheld").forEach(e=>{e.classList.add(eo?"hide":"show"),e.classList.remove(eo?"show":"hide")})},tE=function(){document.querySelectorAll(".settings .options input").forEach(function(e){ea(e),e.addEventListener("click",function(e){let t=JSON.parse(ts("snake-game-settings"));tt("snake-game-settings",JSON.stringify({...t,[e.target.id]:e.target.checked})),"useGamepad"===e.target.id&&eh()})})},t_=function(){let e=JSON.parse(ts("snake-game-settings"));null!==e&&Object.keys(e).forEach(function(t){e[t]&&(document.querySelector(`#${t}`).checked=!0)}),tE()},tS=function(){eo&&(document.querySelector(".settings").classList.remove("hide"),t_())},tA=function(){let e=document.querySelector(".leaderboard");if(eo)e.classList.add("hide");else{e.classList.remove("hide");let s=JSON.parse(ts("snake-game-stats"));if(null!==s&&(s=s.filter(function(e){return e.selectedMode===E})),s&&s.length>0){let n=Object.keys(s[0]),o="<div class='row'>";o+="<div class='column head'>S.No</div>",n.forEach(function(e){"timestamp"!==e&&"time"!==e&&(o+="<div class='column head'>"+e+"</div>")}),o+="</div>";for(let i,l=0;l<t.topScoreLimit;l++)(i=s[l])&&(o+="<div class='row'>",o+="<div class='column'>"+(l+1)+".</div>",n.forEach(function(e){"timestamp"!==e&&"time"!==e&&(o+="<div class='column'>"+i[e]+"</div>")}),o+="</div>");e.innerHTML=o}else e.innerHTML="<div class='message'>"+ei.TOP_N_SCORES+"</div>"}},tb=function(e,t,s,n){let o=250;s=void 0!==s&&s,I=eT(I),U=eT(U),B=eT(B),n&&(eR(),eX()),eM()&&document.querySelector(".maze-mode .head").classList.contains("end")&&(s=!0,t=tT(),tl()),!s&&l>1?(eI(),eS("lifeLost"),eU(l+ei.SPACE+(1===l?ei.LIFE_REMAINING:ei.LIVES_REMAINING)+ei.SPACE+ei.RESUME),eB(ei.PLAY_BUTTON_LABEL)):(o=[250,100,250,100,250,100,250,100,250],eS("over"),e0(),eU(t||ei.GAME_OVER+ei.SPACE+ei.RESET),eo&&(eB(ei.PLAY_BUTTON_LABEL),eD(!0)),eM()||tl()),eo&&e3(!1),to(e,o)},tw=function(){let e=eM()?"maze-path":"body";if("north"===r){if(x.length<i){if(n>$&&te([n-1,o]))x.length>0?x.push([--n,o]):(n-=n===y?0:1,x.push([n,o]));else{tb(7);return}if(eQ([n,o],e))e9(G.shift()),eJ();else{tb(7);return}}else if(G.push(x.shift()),n>$&&eQ([n-1,o],e)){if(x.push([--n,o]),eQ([n,o],e))e9(G.shift()),eJ();else{tb(7);return}}else{tb(7);return}}else if("south"===r){if(x.length<i){if(n<y&&te([n+1,o]))x.length>0?x.push([++n,o]):(n+=n===y?0:1,x.push([n,o]));else{tb(7);return}if(eQ([n,o],e))e9(G.shift()),eJ();else{tb(7);return}}else if(G.push(x.shift()),n<y&&eQ([n+1,o],e)){if(x.push([++n,o]),eQ([n,o],e))e9(G.shift()),eJ();else{tb(7);return}}else{tb(7);return}}else if("east"===r){if(x.length<i){if(o<v&&te([n,o+1]))x.length>0?x.push([n,++o]):(o+=o===v?0:1,x.push([n,o]));else{tb(7);return}if(eQ([n,o],e))e9(G.shift()),eJ();else{tb(7);return}}else if(G.push(x.shift()),o<v&&eQ([n,o+1],e)){if(x.push([n,++o]),eQ([n,o],e))e9(G.shift()),eJ();else{tb(7);return}}else{tb(7);return}}else if("west"===r){if(x.length<i){if(o>m&&te([n,o-1]))x.length>0?x.push([n,--o]):(o-=o===m?0:1,x.push([n,o]));else{tb(7);return}if(eQ([n,o],e))e9(G.shift()),eJ();else{tb(7);return}}else if(G.push(x.shift()),o>m&&eQ([n,o-1],e)){if(x.push([n,--o]),eQ([n,o],e))e9(G.shift()),eJ();else{tb(7);return}}else{tb(7);return}}tP(),t8(),eM()&&F++,ek()&&document.querySelectorAll(".game-arena-display div.path").length===h&&tb(10,tT(),!0)},tT=function(){let e,t=+ts("selected"+eq(E)+"Level")||1,s=+ts("unlocked"+eq(E)+"Levels")||1;return t===s&&t<X?(e=ei.CONGRATULATIONS+ei.COMMA+ei.LEVEL_UNLOCKED+ei.SPACE+ei.RESET,et=!0):e=t<s?ei.CONGRATULATIONS+ei.EXCLAMATION+ei.SPACE+ei.RESET:ei.AMAZING+ei.COMMA+ei.ALL_LEVELS_COMPLETED+ei.SPACE+ei.RESET,e},tq=function(){let e=document.querySelector(".level .value"),t=2,s=setInterval(function(){t+=.5,e.style.background="repeating-radial-gradient(#faad00, transparent "+t+"px)",t>10&&(e.style.background="",eT(s))},100)},tP=function(){let e,t,s=[n,o];if(-1!==(e=V.indexOf(s.toString()))){V.splice(e,1),eZ(s,"food",30),eC(),tn(),i+=ek()?5:1,e8()&&i%j==0&&(ee.innerText=++Q,e1(),e8()&&p<40&&(Q--,tb(10,ei.WELL_DONE,!0,!0),document.querySelectorAll(".food").forEach(function(e){eF(e,"food")}),1)?ee.innerText=Q:(ti(100),tq()));return}-1!==(t=Y.indexOf(s.toString()))&&(eI(),Y.splice(t,1),eZ(s,"danger"),to(),ti(),0===l&&tb())},t8=function(){if(J.style.borderColor="#00ff0d",J.style.background="#00ff0d",e8()&&i>3){J.style.width=Z*i+"%";return}if(ek()){J.style.width=Z*document.querySelectorAll(".game-arena-display div.path").length+"%";return}eM()&&(J.style.width=Z*F+"%")},tk=function(){J.style.width="0px",J.style.borderColor="transparent",J.style.background="transparent",eM()&&(F=0)},tM,tN,tO;tt("unlockedModes",JSON.stringify(["classic","challenge","maze"])),E=ts("selectedMode")||E,eG(+ts("selected"+eq(E)+"Level")||1),e2(),eN(),el(),tM=document.querySelector(".selectMode .modes"),tN=document.createElement("DIV"),g.forEach(function(e){(tO=tN.cloneNode()).setAttribute("data",e),tO.setAttribute("class","mode"),tO.innerText=e,tM.appendChild(tO)}),t$(),tv(),ty(),tg(),tS(),tA(),ez(),eV()}();
